# Vulnerability Assessment Prompts

## 1. Comprehensive Vulnerability Assessment Plan

```
Create a comprehensive vulnerability assessment plan for:

Organization: [ORGANIZATION_NAME]
Assets: [SYSTEMS/APPLICATIONS/NETWORKS]
Assessment Type: [AUTHENTICATED/UNAUTHENTICATED/BOTH]
Frequency: [ONE-TIME/QUARTERLY/MONTHLY]

Plan should include:
1. Asset Inventory
   - Web applications: [LIST]
   - Network devices: [IP_RANGES]
   - Servers: [LIST_SERVERS]
   - Databases: [LIST_DATABASES]
   - Cloud services: [LIST_SERVICES]
   - Mobile applications: [LIST]

2. Assessment Scope
   - In-scope systems
   - Out-of-scope systems
   - Testing windows
   - Bandwidth limitations
   - DoS restrictions

3. Methodology
   - Automated scanning
   - Manual validation
   - False positive verification
   - Risk scoring methodology
   - Reporting format

4. Tools and Techniques
   - Vulnerability scanners
   - Configuration analyzers
   - Patch management verification
   - Compliance checkers

5. Success Criteria
   - Vulnerability coverage
   - False positive rate
   - Time to remediation
   - Risk reduction metrics

6. Deliverables
   - Vulnerability scan reports
   - Risk assessment matrix
   - Remediation roadmap
   - Executive dashboard

Generate:
- Assessment schedule
- Tool configuration
- Reporting templates
- Remediation tracking
```

## 2. Network Infrastructure Vulnerability Assessment

```
Generate vulnerability assessment test cases for:

Network Scope: [IP_RANGES/SUBNETS]
Network Devices: [FIREWALLS/ROUTERS/SWITCHES/IDS_IPS]

Test scenarios:
1. Network Device Scanning
   Nmap comprehensive scan:
   nmap -sS -sV -sC -O -p- [target_range] -oA network_scan

   UDP scan:
   nmap -sU --top-ports 100 [target_range]

   Vulnerability scripts:
   nmap --script vuln [target_range]

2. Firewall Configuration Assessment
   - Rule review
   - Default deny policy
   - Egress filtering
   - Logging configuration
   - Management interface exposure
   - Unnecessary services
   - Outdated firmware

   Tests:
   - Port scan from external network
   - Verify blocked ports
   - Test rule ordering
   - Check for any/any rules

3. Router/Switch Vulnerabilities
   - Default credentials
   - Telnet enabled (should use SSH)
   - HTTP management (should use HTTPS)
   - SNMP v1/v2 (should use v3)
   - CDP/LLDP information leakage
   - VTP attacks
   - STP manipulation

   Commands:
   snmpwalk -v 2c -c public [target]
   cisco-torch -A [target]

4. Wireless Network Assessment
   - WEP/WPA usage (should be WPA2/WPA3)
   - Open networks
   - Weak passwords
   - WPS enabled
   - Rogue access points
   - SSID broadcasting

   Tools:
   - Airodump-ng
   - Kismet
   - WiFi Analyzer

5. Network Service Vulnerabilities
   - FTP (port 21) - anonymous access
   - Telnet (port 23) - unencrypted
   - SMTP (port 25) - open relay
   - DNS (port 53) - zone transfer, recursion
   - SMB (ports 139, 445) - null sessions, EternalBlue
   - RDP (port 3389) - weak passwords, BlueKeep
   - VNC (port 5900) - weak passwords
   - NFS (port 2049) - world-readable shares

6. Network Protocol Vulnerabilities
   - ARP spoofing
   - DNS cache poisoning
   - DHCP starvation
   - VLAN hopping
   - MAC flooding
   - STP attacks

Generate:
- Network scan reports
- Device configuration reviews
- Service hardening checklist
- Network diagram with vulnerabilities
```

## 3. Web Application Vulnerability Assessment

```
Create web application vulnerability assessment for:

Application: [APPLICATION_NAME]
URL: [APPLICATION_URL]
Technology Stack: [TECHNOLOGIES]
Authentication: [AUTH_TYPE]

Test scenarios:
1. Automated Scanning
   OWASP ZAP:
   zap-cli quick-scan --self-contained --spider -r [url]
   zap-cli active-scan [url]

   Nikto:
   nikto -h [url] -ssl -Tuning 123456789 -Format html -o report.html

   WPScan (WordPress):
   wpscan --url [url] --enumerate vp,vt,u,cb --api-token [token]

   Nuclei:
   nuclei -u [url] -t cves/ -t vulnerabilities/ -t exposures/

2. Information Disclosure
   - Directory listing
   - Sensitive file exposure
     * /.git/
     * /.svn/
     * /.env
     * /backup/
     * /admin/
     * /phpinfo.php
     * /config.php
     * /web.config

   - Error messages with stack traces
   - Comments in HTML source
   - Version disclosure in headers

   Tests:
   curl -I [url] | grep -i "Server:"
   curl -I [url] | grep -i "X-Powered-By:"
   view-source:[url]

3. Input Validation Vulnerabilities
   - SQL Injection
     sqlmap -u "[url]?id=1" --batch --level=5 --risk=3

   - Cross-Site Scripting (XSS)
     * Reflected XSS
     * Stored XSS
     * DOM-based XSS

     Payloads:
     <script>alert(1)</script>
     <img src=x onerror=alert(1)>
     "><script>alert(String.fromCharCode(88,83,83))</script>

   - Command Injection
   - XML External Entity (XXE)
   - Server-Side Template Injection (SSTI)
   - LDAP Injection
   - XPath Injection

4. Authentication Vulnerabilities
   - Weak password policy
   - No account lockout
   - Username enumeration
   - Predictable credentials
   - Password reset flaws
   - Remember me functionality
   - Session management issues

5. Authorization Flaws
   - Broken access control
   - Insecure direct object references
   - Missing function level access control
   - Path traversal
   - Privilege escalation

   Tests:
   - Horizontal: Access other user's resources
   - Vertical: Access admin functions as user
   - Parameter manipulation: ?admin=true

6. Session Management
   - Session fixation
   - Session hijacking
   - Weak session IDs
   - Session timeout
   - Concurrent sessions
   - Logout functionality

7. Business Logic Vulnerabilities
   - Price/quantity manipulation
   - Workflow bypass
   - Race conditions
   - Insufficient rate limiting
   - Negative values accepted

8. Cryptographic Issues
   - Weak SSL/TLS configuration
   - Sensitive data in transit
   - Weak hashing algorithms
   - Hardcoded secrets

9. Configuration Issues
   - Default credentials
   - Unnecessary features enabled
   - Debug mode in production
   - Detailed error messages
   - CORS misconfiguration

Generate:
- Comprehensive vulnerability report
- Exploitation proof of concepts
- Risk ratings (CVSS scores)
- Remediation recommendations
```

## 4. Database Vulnerability Assessment

```
Generate database vulnerability assessment for:

Database Type: [MYSQL/POSTGRESQL/MSSQL/ORACLE/MONGODB]
Database Version: [VERSION]
Access Level: [AUTHENTICATED/UNAUTHENTICATED]

Test scenarios:
1. Authentication and Authorization
   - Default credentials
     * MySQL: root/root, root/(blank)
     * PostgreSQL: postgres/postgres
     * MSSQL: sa/sa, sa/(blank)
     * MongoDB: admin/admin (if auth enabled)
     * Oracle: sys/sys, system/manager

   - Weak passwords
   - Password policy enforcement
   - Account lockout mechanisms
   - Privilege separation

2. Configuration Vulnerabilities
   MySQL:
   - Remote root login allowed
   - Anonymous users
   - Test database present
   - Binary logging disabled
   - SSL not enforced

   PostgreSQL:
   - Trust authentication in pg_hba.conf
   - Superuser accessible remotely
   - Unencrypted connections
   - Logging disabled

   MongoDB:
   - No authentication required
   - Publicly accessible
   - No role-based access control
   - JavaScript enabled

3. Known Vulnerabilities
   Run CVE checks:
   - CVE database search for version
   - Exploit-DB search
   - Metasploit module availability

   MySQL version check:
   SELECT VERSION();

   Check for known vulnerabilities:
   nmap --script mysql-vuln-cve2012-2122 [target]

4. Privilege Escalation
   - User with excessive privileges
   - FILE privilege abuse
   - SUPER privilege abuse
   - Load data local infile
   - User-defined functions

   MySQL privilege check:
   SELECT user, host FROM mysql.user;
   SHOW GRANTS FOR 'username'@'host';

5. SQL Injection Testing
   - Authentication bypass
   - Union-based injection
   - Time-based blind injection
   - Error-based injection

6. Data Encryption
   - Encryption at rest
   - Encryption in transit
   - Transparent data encryption (TDE)
   - Column-level encryption
   - Backup encryption

7. Audit and Logging
   - Audit logging enabled
   - Log retention policy
   - Monitoring failed login attempts
   - Tracking privilege changes
   - Query logging

8. Network Security
   - Database exposed to internet
   - Firewall rules
   - Port security
   - VPN/SSH tunneling required

9. Backup Security
   - Backup encryption
   - Backup access controls
   - Backup testing
   - Offsite storage

Generate:
- Database security audit report
- Configuration hardening guide
- Privilege review matrix
- Patch management recommendations
```

## 5. Operating System Vulnerability Assessment

```
Create OS vulnerability assessment for:

Operating System: [LINUX/WINDOWS/MACOS]
Version: [OS_VERSION]
Role: [SERVER/WORKSTATION/APPLIANCE]

Test scenarios:
1. Patch Management
   Linux:
   - Check for available updates:
     apt list --upgradable (Debian/Ubuntu)
     yum check-update (RHEL/CentOS)
   - Check kernel version against known CVEs

   Windows:
   - Windows Update status
   - Missing security patches
   - WSUS configuration

   Tools:
   - Linux: Lynis, OpenSCAP
   - Windows: MBSA, Nessus

2. Service Hardening
   Linux:
   - Unnecessary services running:
     systemctl list-units --type=service --state=running
   - Check for insecure services:
     * Telnet
     * FTP
     * RSH/RCP
     * TFTP

   Windows:
   - Unnecessary services:
     sc query state=all
   - Check for:
     * Remote Registry
     * Print Spooler (if not needed)
     * Remote Desktop (if not needed)

3. User Account Security
   Linux:
   - Check /etc/passwd for unusual accounts
   - Check for accounts with UID 0
   - Review sudo configuration
   - Check for password-less accounts:
     cat /etc/shadow | grep -v '!'

   Windows:
   - Local administrator accounts
   - Guest account status
   - Password policy:
     net accounts
   - Inactive accounts

4. File System Security
   Linux:
   - World-writable files:
     find / -type f -perm -002 -ls
   - SUID/SGID files:
     find / -perm -4000 -o -perm -2000
   - Unowned files:
     find / -nouser -o -nogroup
   - Check /tmp permissions

   Windows:
   - File system permissions
   - Share permissions
   - Registry permissions
   - Audit settings

5. Network Security
   - Open ports:
     netstat -tulpn (Linux)
     netstat -ano (Windows)
   - Firewall status and rules
   - IP forwarding disabled
   - TCP/IP hardening

6. Kernel Security
   Linux:
   - SELinux/AppArmor status
   - Kernel parameters (sysctl)
   - Kernel modules security
   - Secure boot status

   Windows:
   - DEP (Data Execution Prevention)
   - ASLR (Address Space Layout Randomization)
   - Credential Guard
   - Device Guard

7. Logging and Auditing
   Linux:
   - rsyslog/syslog-ng configuration
   - auditd status
   - Log rotation
   - Remote logging

   Windows:
   - Event log settings
   - Audit policies
   - Sysmon installation
   - Log forwarding

8. Authentication Security
   - PAM configuration (Linux)
   - Password complexity
   - Account lockout
   - SSH key management
   - Two-factor authentication

Generate:
- OS hardening checklist
- Compliance report (CIS Benchmarks)
- Patch priority list
- Configuration recommendations
```

## 6. Cloud Infrastructure Vulnerability Assessment

```
Create cloud vulnerability assessment for:

Cloud Provider: [AWS/AZURE/GCP/MULTI-CLOUD]
Services: [LIST_SERVICES]
Assessment Tool: [SCOUT_SUITE/PROWLER/CLOUD_CUSTODIAN]

Test scenarios:
1. AWS Assessment
   Run Prowler:
   ./prowler -M csv,html

   Check for:
   - S3 bucket public access
   - Security group misconfigurations
   - IAM issues:
     * Unused credentials
     * Overly permissive policies
     * MFA not enabled
     * Access key rotation
   - Unencrypted EBS volumes
   - RDS public snapshots
   - CloudTrail logging disabled
   - GuardDuty disabled
   - VPC flow logs disabled

2. Azure Assessment
   Run ScoutSuite:
   scout azure --cli

   Check for:
   - Storage account public access
   - Network security groups (NSGs)
   - Azure AD configuration
   - Key Vault security
   - SQL Database security
   - Virtual machine security
   - Diagnostic logging
   - Azure Security Center

3. GCP Assessment
   Check for:
   - Cloud Storage bucket permissions
   - Firewall rules
   - IAM bindings
   - Service account keys
   - SQL instance security
   - VPC flow logs
   - Cloud Audit Logs
   - Security Command Center

4. Container Security
   - Docker image vulnerabilities:
     trivy image [image:tag]
     docker scan [image:tag]

   - Kubernetes security:
     kube-bench (CIS benchmark)
     kube-hunter
     Check for:
     * Privileged containers
     * Host namespace sharing
     * Insecure API server
     * RBAC misconfigurations

5. Serverless Security
   - Lambda/Function permissions
   - Environment variable security
   - VPC configuration
   - Execution role permissions
   - Function code vulnerabilities

6. API Gateway Security
   - Authentication mechanisms
   - Rate limiting
   - Input validation
   - CORS configuration
   - API keys management

Generate:
- Cloud security posture report
- Resource misconfiguration list
- IAM policy recommendations
- Compliance gaps (CIS, PCI-DSS)
```

## 7. Wireless Network Vulnerability Assessment

```
Create wireless network vulnerability assessment:

Network: [SSID/NETWORK_NAME]
Security: [WPA2/WPA3/OPEN]
Access Points: [NUMBER]

Test scenarios:
1. Wireless Discovery
   - Access point enumeration:
     airodump-ng [interface]
     iwlist [interface] scan

   - Identify:
     * SSID names
     * Security types
     * Signal strength
     * Channel usage
     * MAC addresses

2. Encryption Assessment
   - WEP networks (highly vulnerable)
   - WPA/WPA2-PSK (check password strength)
   - WPA2-Enterprise
   - WPA3 availability
   - Open networks

   Tests:
   - WPA handshake capture:
     airodump-ng -c [channel] --bssid [MAC] -w capture [interface]
   - Deauthentication:
     aireplay-ng --deauth 10 -a [AP_MAC] [interface]
   - Dictionary attack:
     aircrack-ng -w wordlist.txt capture.cap

3. WPS Vulnerability
   - WPS enabled check
   - Reaver attack:
     reaver -i [interface] -b [BSSID] -vv

4. Evil Twin Attack
   - Set up rogue AP
   - SSID impersonation
   - Captive portal
   - Credential harvesting

5. Client Vulnerability
   - Promiscuous probing
   - Saved network exploitation
   - Client isolation testing
   - Man-in-the-middle

6. Configuration Issues
   - Default SSID (Linksys, NETGEAR, TP-Link)
   - Default admin credentials
   - Remote management enabled
   - Firmware outdated
   - WPS enabled
   - SSID broadcasting

7. Physical Security
   - Access point placement
   - Signal leakage outside premises
   - Physical tampering detection
   - MAC address filtering (ineffective)

Generate:
- Wireless security report
- Password strength assessment
- Rogue AP detection results
- Configuration recommendations
```

## 8. IoT Device Vulnerability Assessment

```
Create IoT device vulnerability assessment:

Device Type: [CAMERA/SENSOR/CONTROLLER/SMART_DEVICE]
Device Model: [MODEL]
Firmware Version: [VERSION]

Test scenarios:
1. Device Discovery
   - Network scanning:
     nmap -sP [network_range]
     nmap -sV -p- [device_ip]

   - Shodan search:
     https://www.shodan.io/search?query=[device_type]

   - Identify:
     * Open ports
     * Services running
     * Web interfaces
     * Default credentials

2. Firmware Analysis
   - Firmware extraction
   - Binwalk analysis:
     binwalk -e [firmware.bin]
   - File system examination
   - Hardcoded credentials
   - Encryption keys
   - Backdoors

3. Web Interface Testing
   - Default credentials
   - Authentication bypass
   - Cross-site scripting
   - CSRF vulnerabilities
   - Command injection
   - Directory traversal

4. Network Communication
   - Unencrypted protocols
   - API security
   - Cloud communication security
   - Update mechanism security
   - Certificate validation

5. Physical Interface Testing
   - UART/Serial access
   - JTAG debugging
   - USB interface
   - SD card access
   - Reset mechanisms

6. Privacy and Data Protection
   - Data encryption
   - Personal data exposure
   - Video/audio capture security
   - Data retention
   - User consent

7. Update Mechanism
   - Firmware update security
   - Signature verification
   - Rollback protection
   - Automatic updates
   - Update notification

Generate:
- IoT security assessment report
- Firmware vulnerability analysis
- Network traffic analysis
- Hardening recommendations
```

## 9. Mobile Device Management (MDM) Assessment

```
Create MDM vulnerability assessment:

MDM Solution: [INTUNE/JAMF/MOBILEIRON]
Platform: [IOS/ANDROID/BOTH]
Devices: [NUMBER]

Test scenarios:
1. Policy Assessment
   - Password/PIN requirements
   - Encryption enforcement
   - App whitelisting/blacklisting
   - Certificate management
   - VPN configuration
   - Email security policies

2. Device Enrollment
   - Enrollment process security
   - Zero-touch enrollment
   - BYOD vs Corporate owned
   - Device attestation
   - Enrollment restrictions

3. Application Management
   - App distribution method
   - App wrapping/containerization
   - App store restrictions
   - Enterprise app security
   - MDM profile removal restrictions

4. Data Protection
   - Corporate data encryption
   - Data loss prevention
   - Remote wipe capabilities
   - Selective wipe
   - Container security

5. Compliance Monitoring
   - Jailbreak/root detection
   - Compliance policies
   - Non-compliant device actions
   - Certificate expiration monitoring
   - OS version compliance

6. Network Security
   - Per-app VPN
   - Always-on VPN
   - Wi-Fi configuration
   - Certificate-based authentication
   - Network access control

7. MDM Console Security
   - Admin authentication
   - Role-based access control
   - API security
   - Audit logging
   - Session management

Generate:
- MDM security assessment
- Policy compliance report
- Device vulnerability summary
- Configuration recommendations
```

## 10. Vulnerability Prioritization and Risk Scoring

```
Create vulnerability prioritization framework:

Organization: [ORGANIZATION_NAME]
Assets: [CRITICAL/HIGH/MEDIUM/LOW]

Framework should include:
1. CVSS Scoring
   - Base metrics:
     * Attack Vector (AV)
     * Attack Complexity (AC)
     * Privileges Required (PR)
     * User Interaction (UI)
     * Scope (S)
     * Confidentiality Impact (C)
     * Integrity Impact (I)
     * Availability Impact (A)

   - Temporal metrics:
     * Exploit Code Maturity
     * Remediation Level
     * Report Confidence

   - Environmental metrics:
     * Modified Base Metrics
     * Confidentiality/Integrity/Availability Requirements

2. Risk Matrix
   Likelihood Ã— Impact = Risk Level

   Likelihood factors:
   - Exploit availability
   - Attack complexity
   - Required privileges
   - System exposure

   Impact factors:
   - Data sensitivity
   - Business criticality
   - Compliance requirements
   - Financial impact

3. Prioritization Criteria
   Priority 1 (Critical):
   - CVSS Score: 9.0-10.0
   - Actively exploited
   - Internet-facing
   - No compensating controls

   Priority 2 (High):
   - CVSS Score: 7.0-8.9
   - Proof of concept available
   - Internal network exposure
   - Minimal compensating controls

   Priority 3 (Medium):
   - CVSS Score: 4.0-6.9
   - Difficult to exploit
   - Requires authentication
   - Compensating controls present

   Priority 4 (Low):
   - CVSS Score: 0.1-3.9
   - Theoretical vulnerability
   - Requires physical access
   - Strong compensating controls

4. Remediation Timeline
   - Critical: 1-7 days
   - High: 8-30 days
   - Medium: 31-90 days
   - Low: 91+ days or next maintenance window

5. Compensating Controls
   - WAF rules
   - Network segmentation
   - Access restrictions
   - Monitoring and alerting
   - IDS/IPS signatures

Generate:
- Risk assessment matrix
- Prioritized vulnerability list
- Remediation roadmap
- Executive dashboard
- Compliance gap analysis
```

## Best Practices

1. **Assessment Frequency**
   - Critical systems: Weekly/Monthly
   - Production systems: Monthly/Quarterly
   - Development systems: Quarterly
   - After major changes: Immediately

2. **Authenticated vs Unauthenticated**
   - Authenticated: More accurate, fewer false positives
   - Unauthenticated: External attacker perspective
   - Best practice: Perform both

3. **False Positive Management**
   - Manual verification required
   - Document false positives
   - Tune scanner settings
   - Maintain exception list

4. **Continuous Monitoring**
   - Automated scanning
   - Real-time vulnerability feeds
   - Patch management integration
   - Metrics and trending

5. **Documentation**
   - Baseline assessments
   - Change tracking
   - Remediation evidence
   - Compliance reports

## Tools

**Network Scanning:**
- Nmap, Masscan, Angry IP Scanner

**Vulnerability Scanning:**
- Nessus, OpenVAS, Qualys, Rapid7 Nexpose

**Web Application:**
- Burp Suite, OWASP ZAP, Nikto, Acunetix

**Database:**
- DbProtect, Imperva, AppDetectivePRO

**Configuration:**
- Lynis, CIS-CAT, Microsoft Baseline Security Analyzer

**Cloud:**
- Scout Suite, Prowler, CloudSploit, Prisma Cloud

## Vulnerability Assessment Checklist

- [ ] Scope defined and approved
- [ ] Asset inventory completed
- [ ] Tools configured
- [ ] Baseline scan performed
- [ ] Authenticated scan completed
- [ ] Manual verification done
- [ ] False positives identified
- [ ] Vulnerabilities prioritized
- [ ] Risk scores assigned
- [ ] Report generated
- [ ] Remediation plan created
- [ ] Findings communicated
- [ ] Remediation tracking started
- [ ] Re-scan scheduled
